!function(n){"use strict";function e(){}function t(n){return function(){return n}}function r(n){return n}function o(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}function u(){return tt}function i(n){return n.isNone()}function c(n){return n()}function a(n){return n}function f(n){return function(e){return function(n){if(null===n)return"null";var e=typeof n;return"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(e)===n}}function s(n,e){return-1<function(n,e){return lt.call(n,e)}(n,e)}function l(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1}function m(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t}function d(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r}function v(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)}function h(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t}function p(n,e){if(0===n.length)return[];for(var t=e(n[0]),r=[],o=[],u=0,i=n.length;u<i;u++){var c=n[u],a=e(c);a!==t&&(r.push(o),o=[]),t=a,o.push(c)}return 0!==o.length&&r.push(o),r}function g(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,function(n){t=e(t,n)}),t}function w(n,e,t){return v(n,function(n){t=e(t,n)}),t}function b(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t))return ot.some(o)}return ot.none()}function y(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return ot.some(t);return ot.none()}function S(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!it(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);mt.apply(e,n[t])}return e}function T(n,e){var t=d(n,e);return S(t)}function x(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0}function C(n,e){var t=st.call(n,0);return t.sort(e),t}function O(n){return parseInt(n,10)}function E(n,e,t){return{major:n,minor:e,patch:t}}function N(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?E(O(e[1]),O(e[2]),O(e[3])):E(0,0,0)}function A(n,e){var t=n-e;return 0==t?0:0<t?1:-1}function R(n,e){return!!n&&-1===function(n,e){var t=A(n.major,e.major);if(0!==t)return t;var r=A(n.minor,e.minor);if(0!==r)return r;var o=A(n.patch,e.patch);return 0!==o?o:0}(function(n){return N(function(n){return[n.majorVersion,n.minorVersion].join(".").split(".").slice(0,3).join(".")}(n))}(n),N(e))}function D(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(n.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+e.length+" arguments");var o={};return v(n,function(n,r){o[n]=t(e[r])}),o}}function k(n,e){for(var t=dt(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}}function j(n){return n.slice(0).sort()}function I(n,e){throw new Error("All required keys ("+j(n).join(", ")+") were not specified. Specified keys were: "+j(e).join(", ")+".")}function M(n){throw new Error("Unsupported keys for object: "+j(n).join(", "))}function P(n,e){if(!it(e))throw new Error("The "+n+" fields must be an array. Was: "+e+".");v(e,function(e){if(!ut(e))throw new Error("The value "+e+" in the "+n+" fields was not a string.")})}function _(n){var e=j(n);b(e,function(n,t){return t<e.length-1&&n===e[t+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}function B(n,e){var t=h(e,function(e){return!s(n,e)});0<t.length&&M(t)}function q(n){return n.dom().nodeName.toLowerCase()}function L(n){return n.dom().nodeType}function z(n){return function(e){return L(e)===n}}function V(n){return L(n)===pt||"#comment"===q(n)}function F(e,t,r){if(!(ut(r)||ct(r)||ft(r)))throw n.console.error("Invalid call to Attr.set. Key ",t,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,r+"")}function W(n,e,t){F(n.dom(),e,t)}function G(n,e){var t=n.dom();k(e,function(n,e){F(t,e,n)})}function U(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t}function H(n,e){var t=n.dom();return!(!t||!t.hasAttribute)&&t.hasAttribute(e)}function X(n,e){n.dom().removeAttribute(e)}function Y(n){return w(n.dom().attributes,function(n,e){return n[e.name]=e.value,n},{})}function $(n,e){return-1!==n.indexOf(e)}function K(n){return void 0!==n.style&&at(n.style.getPropertyValue)}function J(n){var e=St(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)}function Q(e,t,r){if(!ut(r))throw n.console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);K(e)&&e.style.setProperty(t,r)}function Z(n,e,t){var r=n.dom();Q(r,e,t)}function nn(n,e){var t=n.dom();k(e,function(n,e){Q(t,e,n)})}function en(e,t){var r=e.dom(),o=n.window.getComputedStyle(r).getPropertyValue(t),u=""!==o||J(e)?o:Ct(r,t);return null===u?void 0:u}function tn(n,e){var t=n.dom(),r=Ct(t,e);return ot.from(r).filter(function(n){return 0<n.length})}function rn(n,e){!function(n,e){K(n)&&n.style.removeProperty(e)}(n.dom(),e),H(n,"style")&&""===function(n){return n.replace(/^\s+|\s+$/g,"")}(U(n,"style"))&&X(n,"style")}function on(n){var e=H(n,"colspan")?parseInt(U(n,"colspan"),10):1,r=H(n,"rowspan")?parseInt(U(n,"rowspan"),10):1;return{element:t(n),colspan:t(e),rowspan:t(r)}}function un(n,e){return n.cells()[e]}function cn(n,e){function t(n){return Number(e.replace(r,"$"+n))}var r=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);return r?zt(t(1),t(2)):{major:0,minor:0}}function an(n,e){return function(){return e===n}}function fn(n,e){return function(){return e===n}}function sn(n,e){var t=String(e).toLowerCase();return b(n,function(n){return n.search(t)})}function ln(n){return function(e){return $(e,n)}}function mn(n,e){var t=n.dom();if(t.nodeType!==or)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function dn(n){return n.nodeType!==or&&n.nodeType!==ur||0===n.childElementCount}function vn(n,e){return n.dom()===e.dom()}function hn(n){return xt.fromDom(n.dom().ownerDocument)}function pn(n){return ot.from(n.dom().parentNode).map(xt.fromDom)}function gn(n,e){for(var t=at(e)?e:nt,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=xt.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function wn(n){return ot.from(n.dom().previousSibling).map(xt.fromDom)}function bn(n){return ot.from(n.dom().nextSibling).map(xt.fromDom)}function yn(n){return d(n.dom().childNodes,xt.fromDom)}function Sn(n){return function(n,e){var t=n.dom().childNodes;return ot.from(t[e]).map(xt.fromDom)}(n,0)}function Tn(n,e,t){return function(n,e,t){return h(gn(n,t),e)}(n,function(n){return mn(n,e)},t)}function xn(n,e){return function(n,e){return h(yn(n),e)}(n,function(n){return mn(n,e)})}function Cn(e,t){return function(e,t){var r=void 0===t?n.document:t.dom();return dn(r)?[]:d(r.querySelectorAll(e),xt.fromDom)}(t,e)}function On(n,e,r){for(var o=n.dom(),u=at(r)?r:t(!1);o.parentNode;){o=o.parentNode;var i=xt.fromDom(o);if(e(i))return ot.some(i);if(u(i))break}return ot.none()}function En(n,e,t){return On(n,function(n){return mn(n,e)},t)}function Nn(n,e){return function(n,e){return b(n.dom().childNodes,function(n){return e(xt.fromDom(n))}).map(xt.fromDom)}(n,function(n){return mn(n,e)})}function An(e,t){return function(e,t){var r=void 0===t?n.document:t.dom();return dn(r)?ot.none():ot.from(r.querySelector(e)).map(xt.fromDom)}(t,e)}function Rn(n,e,t){return function(n,e,t,r,o){return n(t,r)?ot.some(t):at(o)&&o(t)?ot.none():e(t,r,o)}(mn,En,n,e,t)}function Dn(n,e,t){return void 0===t&&(t=nt),t(e)?ot.none():s(n,q(e))?ot.some(e):En(e,n.join(","),function(n){return mn(n,"table")||t(n)})}function kn(n,e){return pn(e).map(function(e){return xn(e,n)})}function jn(n,e){pn(n).each(function(t){t.dom().insertBefore(e.dom(),n.dom())})}function In(n,e){bn(n).fold(function(){pn(n).each(function(n){vr(n,e)})},function(n){jn(n,e)})}function Mn(n,e){Sn(n).fold(function(){vr(n,e)},function(t){n.dom().insertBefore(e.dom(),t.dom())})}function Pn(n,e){jn(n,e),vr(e,n)}function _n(n,e){v(e,function(t,r){var o=0===r?n:e[r-1];In(o,t)})}function Bn(n,e){v(e,function(e){vr(n,e)})}function qn(n){n.dom().textContent="",v(yn(n),function(n){hr(n)})}function Ln(n){var e=yn(n);0<e.length&&function(n,e){v(e,function(e){jn(n,e)})}(n,e),hr(n)}function zn(n,e){return xt.fromDom(n.dom().cloneNode(e))}function Vn(n){return zn(n,!1)}function Fn(n){return zn(n,!0)}function Wn(n,e){var t=function(n,e){var t=xt.fromTag(e),r=Y(n);return G(t,r),t}(n,e),r=yn(Fn(n));return Bn(t,r),t}function Gn(n,e,t,r){t===r?X(n,e):W(n,e,t)}function Un(n,e){function t(t){var r=e(t);if(r<=0||null===r){var o=en(t,n);return parseFloat(o)||0}return r}function r(n,e){return w(e,function(e,t){var r=en(n,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)}return{set:function(e,t){if(!ft(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);var r=e.dom();K(r)&&(r.style[n]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(n,e,t){var o=r(n,t);return o<e?e-o:0}}}function Hn(n){return gr.getOuter(n)}function Xn(n,e){return void 0!==n?n:void 0!==e?e:0}function Yn(n){var e=n.dom().ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom())return br(t.offsetLeft,t.offsetTop);var u=Xn(r.pageYOffset,o.scrollTop),i=Xn(r.pageXOffset,o.scrollLeft),c=Xn(o.clientTop,t.clientTop),a=Xn(o.clientLeft,t.clientLeft);return yr(n).translate(i-a,u-c)}function $n(n){return Sr.getOuter(n)}function Kn(n){return Yn(n).left()+$n(n)}function Jn(n){return Yn(n).left()}function Qn(n,e){return xr(n,Jn(e))}function Zn(n,e){return xr(n,Kn(e))}function ne(n){return Yn(n).top()}function ee(n,e){return Tr(n,ne(e))}function te(n,e){return Tr(n,ne(e)+Hn(e))}function re(n,e,t){if(0===t.length)return[];var r=d(t.slice(1),function(e,t){return e.map(function(e){return n(t,e)})}),o=t[t.length-1].map(function(n){return e(t.length-1,n)});return r.concat([o])}function oe(n,e){var t=U(n,e);return void 0===t||""===t?[]:t.split(" ")}function ue(n){return void 0!==n.dom().classList}function ie(n,e){return function(n,e,t){var r=oe(n,e).concat([t]);return W(n,e,r.join(" ")),!0}(n,"class",e)}function ce(n,e){ue(n)?n.dom().classList.add(e):ie(n,e)}function ae(n,e){return n+","+e}function fe(n,e){for(var t=[],r=n;r<e;r++)t.push(r);return t}function se(n){var e=Cn(n.parent(),"."+Mr);v(e,hr)}function le(n,e,t){var r=n.origin();v(e,function(e,o){e.each(function(e){var o=t(r,e);ce(o,Mr),vr(n.parent(),o)})})}function me(n,e,t,r,o,u){var i=Yn(e);!function(n,e,t,r){le(n,e,function(n,e){var o=Ir(e.row(),t.left()-n.left(),e.y()-n.top(),r,7);return ce(o,Pr),o})}(n,0<t.length?o.positions(t,e):[],i,$n(e)),function(n,e,t,r){le(n,e,function(n,e){var o=jr(e.col(),e.x()-n.left(),t.top()-n.top(),7,r);return ce(o,_r),o})}(n,0<r.length?u.positions(r,e):[],i,Hn(e))}function de(n,e){if(0===n.length)return 0;var t=n[0];return y(n,function(n){return!e(t.element(),n.element())}).fold(function(){return n.length},function(n){return n})}function ve(n,e){function t(n){return function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return ot.none()}(n,function(n){return pn(n.element()).map(function(n){var e=pn(n).isNone();return jt(n,e)})}).getOrThunk(function(){return jt(e.row(),!0)})}return d(n,function(n){var e=t(n.details());return It(e.element(),n.details(),n.section(),e.isNew())})}function he(n,e){var t=S(d(n.all(),function(n){return n.cells()}));return b(t,function(n){return vn(e,n.element())})}function pe(n,e,r,o,u){return function(i,c,a,f,s){var l=Dr(c),m=Er.generate(l);return e(m,a).map(function(e){var r=function(n,e){return zr(n,e,!1)}(m,f),o=n(r,e,vn,u(f)),i=function(n,e){var t=Lr(n,vn);return ve(t,e)}(o.grid(),f);return{grid:t(i),cursor:o.cursor}}).fold(function(){return ot.none()},function(n){var e=pr(c,n.grid());return r(c,n.grid(),s),o(c),Br(i,c,Cr.height,s),ot.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})})}}function ge(n,e){return sr(e.element()).bind(function(e){return he(n,e)})}function we(n,e){var t=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}(d(e.selection(),function(e){return sr(e).bind(function(e){return he(n,e)})}));return 0<t.length?ot.some(t):ot.none()}function be(n){function e(e){return n(e).isRtl()?Vr.rtl:Vr.ltr}return{delta:function(n,t){return e(t).delta(n,t)},edge:function(n){return e(n).edge(n)},positions:function(n,t){return e(t).positions(n,t)}}}function ye(n){return Fr.get(n)}function Se(n,e){Fr.set(n,e)}function Te(n){return function(n){return Fr.getOption(n)}(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("聽")}).isSome()}function xe(n){return Te(n)||s(Wr,q(n))}function Ce(n){return function(n,e){var t=function(n){for(var r=0;r<n.childNodes.length;r++){var o=xt.fromDom(n.childNodes[r]);if(e(o))return ot.some(o);var u=t(n.childNodes[r]);if(u.isSome())return u}return ot.none()};return t(n.dom())}(n,xe)}function Oe(){var n=xt.fromTag("td");return vr(n,xt.fromTag("br")),n}function Ee(n,e,t){var r=Wn(n,e);return k(t,function(n,e){null===n?X(r,e):W(r,e,n)}),r}function Ne(n){return function(){return xt.fromTag("tr",n.dom())}}function Ae(n){return n.dom().textContent}function Re(n){return n.getBoundingClientRect().width}function De(n){return xt.fromDom(n.getBody())}function ke(n){var e=Cn(n,"td[data-mce-style],th[data-mce-style]");X(n,"data-mce-style"),v(e,function(n){X(n,"data-mce-style")})}function je(n){var e=parseFloat(n);return isNaN(e)?ot.none():ot.some(e)}function Ie(n,e){return n<e?-1:e<n?1:0}function Me(n,e){return function(n,e,t){return n.isSome()&&e.isSome()?ot.some(t(n.getOrDie(),e.getOrDie())):ot.none()}(je(n),je(e),Ie).getOrThunk(function(){return function(n,e){return n.localeCompare(e)}(n,e)})}function Pe(n,t){function r(e,r,o){return function(u,i){ke(u);var c=t().resizeHandler.lazyWire(),a=xt.fromDom(n.getDoc()),f=be(Xr),s=Gr(o,a,N);return r(u)?e(c,u,i,s,f).bind(function(e){return v(e.newRows(),function(e){!function(n,e){n.fire("newrow",{node:e})}(n,e.dom())}),v(e.newCells(),function(e){!function(n,e){n.fire("newcell",{node:e})}(n,e.dom())}),e.cursor().map(function(e){var t=n.dom.createRng();return t.setStart(e.dom(),0),t.setEnd(e.dom(),0),t})}):ot.none()}}function o(n,e,t){return A(n,function(n,e,t){return ot.from(n[e]).bind(function(n){return ot.from(n.cells()[t]).bind(function(n){return ot.from(n.element())})})}(n,e,t))}function u(n,e,t,r){var o=p(n,function(n){return n.section()}),u=d(o,function(n){return p(n,function(n){return q(Bt(n,e).element())})});return T(u,function(n){return T(n,function(n){return"th"===q(Bt(n[0],e).element())?n:function(n){var o=d(n,function(n){var t=Bt(n,e);return{row:n,text:Ae(t.element())}}),u=C(o,function(n,e){var o=t(n.text,e.text);return r?o:-1*o});return d(u,function(n){return n.row})}(n)})})}function i(n,e,t,r){var o=n[e].cells(),u=d(o,function(n){return Ae(n.element())}),i=d(n,function(n){return{zippedCells:d(n.cells(),function(n,e){return{cell:n,reference:o[e],referenceText:u[e]}}),section:n.section()}});return d(i,function(n){var e=p(n.zippedCells,function(n){return q(n.reference.element())}),o=T(e,function(n){return"th"===q(n[0].reference.element())?n:C(n,function(n,e){var o=t(n.referenceText,e.referenceText);return r?o:-1*o})}),u=d(o,function(n){return n.cell});return Mt(u,n.section)})}function c(n,e,t,r,o){var u=n.slice(0,e),i=n.slice(e,t+1);return{beforeRows:u,afterRows:n.slice(t+1,n.length),selectionGridBefore:i.map(function(n){return{cells:function(){return n.cells().slice(0,r)},section:function(){return n.section()}}}),selectionGrid:i.map(function(n){return{cells:function(){return n.cells().slice(r,o+1)},section:function(){return n.section()}}}),selectionGridAfter:i.map(function(n){return{cells:function(){return n.cells().slice(o+1,n.cells().length)},section:function(){return n.section()}}})}}function a(n,e){var t=d(e,function(e,t){var r=n.selectionGridBefore[t].cells(),o=n.selectionGridAfter[t].cells();return{cells:function(){return r.concat(e.cells()).concat(o)},section:function(){return e.section()}}});return n.beforeRows.concat(t).concat(n.afterRows)}function f(n,e,t,r,o,i,f,s){var l=c(n,t,r,o,i),m=u(l.selectionGrid,e-o,f,s);return a(l,m)}function s(n,e,t,r,o,u,f,s){var l=c(n,t,r,o,u),m=i(l.selectionGrid,e-t,f,s);return a(l,m)}function m(n){return w(n,function(n,e){return l(n,function(n){return n.row()===e.row()})?n:n.concat([e])},[]).sort(function(n,e){return n.row()-e.row()})}function h(n){return w(n,function(n,e){return l(n,function(n){return n.column()===e.column()})?n:n.concat([e])},[]).sort(function(n,e){return n.column()-e.column()})}function g(n,e,t,r,u){var i=f(n,u,0,n.length,u,u,t,r);return o(i,e[0].row(),e[0].column())}function b(n,e,t,r,u){var i=m(e),c=h(e),a=f(n,u,i[0].row(),i[i.length-1].row(),c[0].column(),c[c.length-1].column(),t,r);return o(a,e[0].row(),e[0].column())}function y(n,e,t,r,u){var i=R(n,u,t,r);return o(i,e.row(),e.column())}function S(n,e,t,r,u){var i=s(n,u,u,u,0,n[e[0].row()].cells().length,t,r);return o(i,e[0].row(),e[0].column())}function x(n,e,t,r,u){var i=m(e),c=h(e),a=s(n,u,i[0].row(),i[i.length-1].row(),c[0].column(),c[c.length-1].column(),t,r);return o(a,e[0].row(),e[0].column())}function O(n,e,t,r,u){var i=k(n,u,t,r);return o(i,e.row(),e.column())}function E(n,t,r,o,u){return function(i,c,a,f,s){return pe(function(e,u){return n(e,u,t,r,o)},u,e,e,Et)(i,c,a,f,s)}}var N=function(n){var e=n.getParam("table_clone_elements");return ut(e)?ot.some(e.split(/[ ,]/)):Array.isArray(e)?ot.some(e):ot.none()}(n),A=D("grid","cursor"),R=u,k=i;return{sortColumnRowsAsc:function(n){return r(E(g,Me,!0,n,we),et,e)},sortColumnRowsDesc:function(n){return r(E(g,Me,!1,n,we),et,e)},sortSelectionRowsAsc:function(n){return r(E(b,Me,!0,n,we),et,e)},sortSelectionRowsDesc:function(n){return r(E(b,Me,!1,n,we),et,e)},sortTableRowsAsc:function(n){return r(E(y,Me,!0,n,ge),et,e)},sortTableRowsDesc:function(n){return r(E(y,Me,!1,n,ge),et,e)},sortRowColumnsAsc:function(n){return r(E(S,Me,!0,n,we),et,e)},sortRowColumnsDesc:function(n){return r(E(S,Me,!1,n,we),et,e)},sortSelectionColumnsAsc:function(n){return r(E(x,Me,!0,n,we),et,e)},sortSelectionColumnsDesc:function(n){return r(E(x,Me,!1,n,we),et,e)},sortTableColumnsAsc:function(n){return r(E(O,Me,!0,n,ge),et,e)},sortTableColumnsDesc:function(n){return r(E(O,Me,!1,n,ge),et,e)}}}function _e(n,e){return e.column()>=n.startCol()&&e.column()+e.colspan()-1<=n.finishCol()&&e.row()>=n.startRow()&&e.row()+e.rowspan()-1<=n.finishRow()}function Be(n,e,t){var r=Er.findItem(n,e,vn),o=Er.findItem(n,t,vn);return r.bind(function(n){return o.map(function(e){return function(n,e){return _t(Math.min(n.row(),e.row()),Math.min(n.column(),e.column()),Math.max(n.row()+n.rowspan()-1,e.row()+e.rowspan()-1),Math.max(n.column()+n.colspan()-1,e.column()+e.colspan()-1))}(n,e)})})}function qe(n,e,r){var u=n.property().children(e);return y(u,o(n.eq,r)).map(function(n){return{before:t(u.slice(0,n)),after:t(u.slice(n+1))}})}function Le(n,e){return o(n.eq,e)}function ze(n,e,t,r){function o(t){var r=function(n){var e=st.call(n,0);return e.reverse(),e}(t),o=y(r,Le(n,e)).getOr(-1),i=o<r.length-1?r[o+1]:r[o];return y(u,Le(n,i))}var u=n.property().children(e);if(n.eq(e,t[0]))return ot.some([t[0]]);if(n.eq(e,r[0]))return ot.some([r[0]]);var i=o(t),c=o(r);return i.bind(function(n){return c.map(function(e){var t=Math.min(n,e),r=Math.max(n,e);return u.slice(t,r+1)})})}function Ve(n,e,r,o){function u(n){return y(n,o).fold(function(){return n},function(e){return n.slice(0,e+1)})}void 0===o&&(o=nt);var i=[e].concat(n.up().all(e)),c=[r].concat(n.up().all(r)),a=u(i),f=u(c),s=b(a,function(e){return l(f,Le(n,e))});return{firstpath:t(a),secondpath:t(f),shared:t(s)}}function Fe(n){return En(n,"table")}function We(n,e){return go.cata(e.get(),t([]),r,t([n]))}function Ge(n,e){var t=function(n){return function(e){return vn(e,De(n))}}(e);return mr(n,t)}function Ue(n){return function(e){var t=e.getData();e.close(),n.undoManager.transact(function(){n.execCommand("mceSortTableAdvanced",!1,t),n.focus(),n.addVisual()})}}function He(n,e,t){function r(e){return function(){return n.execCommand(e)}}n.on("init",function(){var o=[{type:"menuitem",text:"Sort table by column ascending",onAction:r("mceSortTableByColumnAsc"),onSetup:e().selectionTargets.onSetupCellOrRow},{type:"menuitem",text:"Sort table by column descending",onAction:r("mceSortTableByColumnDesc"),onSetup:e().selectionTargets.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Advanced sort...",onAction:function(){return Co(n,t)},onSetup:e().selectionTargets.onSetupCellOrRow}];n.ui.registry.addNestedMenuItem("advtablesort",{type:"nestedmenuitem",text:"Sort",getSubmenuItems:function(){return o}})})}function Xe(n){var e,t;if(R(tinymce,"5.1.2"))return console.error("Please use Advanced Tables with TinyMCE 5.1.2 or later."),{};if(e="table",t=n.settings.plugins?n.settings.plugins:"",s(t.split(/[ ,]/),e)){var r=function(){return n.plugins.table},o=Pe(n,r),u=function(n){return{get:function(){var e=De(n);return fo(e,ho.selectedSelector()).fold(function(){return void 0===n.selection.getStart()?go.none():go.single(n.selection)},function(n){return go.multiple(n)})}}}(n);Oo(n,o,u),He(n,r,u)}else console.log("Please use the Advanced Tables Plugin together with the Tables plugin.");return{}}var Ye,$e,Ke,Je,Qe,Ze,nt=t(!1),et=t(!0),tt=(Ye={fold:function(n,e){return n()},is:nt,isSome:nt,isNone:et,getOr:a,getOrThunk:c,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:a,orThunk:c,map:u,each:e,bind:u,exists:nt,forall:et,filter:u,equals:i,equals_:i,toArray:function(){return[]},toString:t("none()")},Object.freeze&&Object.freeze(Ye),Ye),rt=function(n){function e(){return u}function r(e){return e(n)}var o=t(n),u={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:et,isNone:nt,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return rt(e(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?u:tt},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(nt,function(e){return t(n,e)})}};return u},ot={some:rt,none:u,from:function(n){return null==n?tt:rt(n)}},ut=f("string"),it=f("array"),ct=f("boolean"),at=f("function"),ft=f("number"),st=Array.prototype.slice,lt=Array.prototype.indexOf,mt=Array.prototype.push,dt=(at(Array.from)&&Array.from,Object.keys),vt=function(n){function e(){return t}var t=n;return{get:e,set:function(n){t=n},clone:function(){return vt(e())}}},ht=function(n,e,t){if(0===e.length)throw new Error("You must specify at least one required field.");return P("required",e),_(e),function(r){var o=dt(r);x(e,function(n){return s(o,n)})||I(e,o),n(e,o);var u=h(e,function(n){return!t.validate(r[n],n)});return 0<u.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+j(n).join(", ")+") were not.")}(u,t.label),r}},pt=(n.Node.ATTRIBUTE_NODE,n.Node.CDATA_SECTION_NODE,n.Node.COMMENT_NODE),gt=n.Node.DOCUMENT_NODE,wt=(n.Node.DOCUMENT_TYPE_NODE,n.Node.DOCUMENT_FRAGMENT_NODE,n.Node.ELEMENT_NODE),bt=n.Node.TEXT_NODE,yt=(n.Node.PROCESSING_INSTRUCTION_NODE,n.Node.ENTITY_REFERENCE_NODE,n.Node.ENTITY_NODE,n.Node.NOTATION_NODE,void 0!==n.window?n.window:Function("return this;")(),z(wt)),St=z(bt),Tt=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:t(n)}},xt={fromHtml:function(e,t){var r=(t||n.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw n.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Tt(r.childNodes[0])},fromTag:function(e,t){var r=(t||n.document).createElement(e);return Tt(r)},fromText:function(e,t){var r=(t||n.document).createTextNode(e);return Tt(r)},fromDom:Tt,fromPoint:function(n,e,t){var r=n.dom();return ot.from(r.elementFromPoint(e,t)).map(Tt)}},Ct=function(n,e){return K(n)?n.style.getPropertyValue(e):""},Ot=ht(B,["cell","row","replace","gap"],{validate:at,label:"function"}),Et=function(n,e){function t(t){return function(e){return n.cell(e)}(e(t))}function r(n){var e=t(n);return o.get().isNone()&&o.set(ot.some(e)),u=ot.some({item:n,replacement:e}),e}void 0===e&&(e=on),Ot(n);var o=vt(ot.none()),u=ot.none();return{getOrInit:function(n,e){return u.fold(function(){return r(n)},function(t){return e(n,t.item)?t.replacement:r(n)})},cursor:o.get}},Nt=(D("width","height"),D("width","height"),D("rows","columns")),At=(D("row","column"),D("x","y"),D("element","rowspan","colspan")),Rt=D("element","rowspan","colspan","isNew"),Dt=D("element","rowspan","colspan","row","column"),kt=D("element","cells","section"),jt=D("element","isNew"),It=D("element","cells","section","isNew"),Mt=D("cells","section"),Pt=D("details","section"),_t=D("startRow","startCol","finishRow","finishCol"),Bt=un,qt=function(){return(qt=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)},Lt=function(){return zt(0,0)},zt=function(n,e){return{major:n,minor:e}},Vt={nu:zt,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?Lt():cn(n,t)},unknown:Lt},Ft="Firefox",Wt=function(n){var e=n.current;return{current:e,version:n.version,isEdge:an("Edge",e),isChrome:an("Chrome",e),isIE:an("IE",e),isOpera:an("Opera",e),isFirefox:an(Ft,e),isSafari:an("Safari",e)}},Gt={unknown:function(){return Wt({current:void 0,version:Vt.unknown()})},nu:Wt,edge:t("Edge"),chrome:t("Chrome"),ie:t("IE"),opera:t("Opera"),firefox:t(Ft),safari:t("Safari")},Ut="Windows",Ht="Android",Xt="Solaris",Yt="FreeBSD",$t=function(n){var e=n.current;return{current:e,version:n.version,isWindows:fn(Ut,e),isiOS:fn("iOS",e),isAndroid:fn(Ht,e),isOSX:fn("OSX",e),isLinux:fn("Linux",e),isSolaris:fn(Xt,e),isFreeBSD:fn(Yt,e)}},Kt={unknown:function(){return $t({current:void 0,version:Vt.unknown()})},nu:$t,windows:t(Ut),ios:t("iOS"),android:t(Ht),linux:t("Linux"),osx:t("OSX"),solaris:t(Xt),freebsd:t(Yt)},Jt=function(n,e){return sn(n,e).map(function(n){var t=Vt.detect(n.versionRegexes,e);return{current:n.name,version:t}})},Qt=function(n,e){return sn(n,e).map(function(n){var t=Vt.detect(n.versionRegexes,e);return{current:n.name,version:t}})},Zt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,nr=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return $(n,"edge/")&&$(n,"chrome")&&$(n,"safari")&&$(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Zt],search:function(n){return $(n,"chrome")&&!$(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return $(n,"msie")||$(n,"trident")}},{name:"Opera",versionRegexes:[Zt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ln("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ln("firefox")},{name:"Safari",versionRegexes:[Zt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return($(n,"safari")||$(n,"mobile/"))&&$(n,"applewebkit")}}],er=[{name:"Windows",search:ln("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return $(n,"iphone")||$(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ln("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ln("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ln("linux"),versionRegexes:[]},{name:"Solaris",search:ln("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ln("freebsd"),versionRegexes:[]}],tr={browsers:t(nr),oses:t(er)},rr=vt(function(n,e){var r=tr.browsers(),o=tr.oses(),u=Jt(r,n).fold(Gt.unknown,Gt.nu),i=Qt(o,n).fold(Kt.unknown,Kt.nu);return{browser:u,os:i,deviceType:function(n,e,r,o){var u=n.isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!u,c=n.isiOS()||n.isAndroid(),a=c||o("(pointer:coarse)"),f=u||!i&&c&&o("(min-device-width:768px)"),s=i||c&&!f,l=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),m=!s&&!f&&!l;return{isiPad:t(u),isiPhone:t(i),isTablet:t(f),isPhone:t(s),isTouch:t(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:t(l),isDesktop:t(m)}}(i,u,n,e)}}(n.navigator.userAgent,function(e){return n.window.matchMedia(e).matches})),or=wt,ur=gt,ir=(rr.get().browser.isIE(),mn),cr=(D("element","offset"),function(n,e){var t=[];return v(yn(n),function(n){e(n)&&(t=t.concat([n])),t=t.concat(cr(n,e))}),t}),ar=function(n,e,t){return T(yn(n),function(n){return mn(n,e)?t(n)?[n]:[]:ar(n,e,t)})},fr=function(n,e){return ar(n,e,t(!0))},sr=(o(kn,"th,td"),o(kn,"tr"),function(n,e){return Dn(["td","th"],n,e)}),lr=function(n){return fr(n,"th,td")},mr=function(n,e){return Rn(n,"table",e)},dr=function(n){return fr(n,"tr")},vr=function(n,e){n.dom().appendChild(e.dom())},hr=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},pr=function(n,e){function r(e,t){0<e.length?function(e,t){var r=Nn(n,t).getOrThunk(function(){var e=xt.fromTag(t,hn(n).dom());return vr(n,e),e});qn(r);var i=d(e,function(n){n.isNew()&&o.push(n.element());var e=n.element();return qn(e),v(n.cells(),function(n){n.isNew()&&u.push(n.element()),Gn(n.element(),"colspan",n.colspan(),1),Gn(n.element(),"rowspan",n.rowspan(),1),vr(e,n.element())}),e});Bn(r,i)}(e,t):function(e){Nn(n,e).each(hr)}(t)}var o=[],u=[],i=[],c=[],a=[];return v(e,function(n){switch(n.section()){case"thead":i.push(n);break;case"tbody":c.push(n);break;case"tfoot":a.push(n)}}),r(i,"thead"),r(c,"tbody"),r(a,"tfoot"),{newRows:t(o),newCells:t(u)}},gr=Un("height",function(n){var e=n.dom();return J(n)?e.getBoundingClientRect().height:e.offsetHeight}),wr=function(n,e){return{left:t(n),top:t(e),translate:function(t,r){return wr(n+t,e+r)}}},br=wr,yr=function(n){var e=n.dom(),t=e.ownerDocument.body;return t===e?br(t.offsetLeft,t.offsetTop):J(n)?function(n){var e=n.getBoundingClientRect();return br(e.left,e.top)}(e):br(0,0)},Sr=Un("width",function(n){return n.dom().offsetWidth}),Tr=D("row","y"),xr=D("col","x"),Cr={height:{delta:r,positions:function(n){return re(ee,te,n)},edge:ne},rtl:{delta:function(n){return-n},edge:Kn,positions:function(n){return re(Zn,Qn,n)}},ltr:{delta:r,edge:Jn,positions:function(n){return re(Qn,Zn,n)}}},Or=function(n,e){var t=T(n.all(),function(n){return n.cells()});return h(t,e)},Er={generate:function(n){var e={},r=[],o=n.length,u=0;v(n,function(n,t){var o=[];v(n.cells(),function(n){for(var r=0;void 0!==e[ae(t,r)];)r++;for(var i=Dt(n.element(),n.rowspan(),n.colspan(),t,r),c=0;c<n.colspan();c++)for(var a=0;a<n.rowspan();a++){var f=r+c,s=ae(t+a,f);e[s]=i,u=Math.max(u,f+1)}o.push(i)}),r.push(kt(n.element(),o,n.section()))});var i=Nt(o,u);return{grid:t(i),access:t(e),all:t(r)}},getAt:function(n,e,t){var r=n.access()[ae(e,t)];return void 0!==r?ot.some(r):ot.none()},findItem:function(n,e,t){var r=Or(n,function(n){return t(e,n.element())});return 0<r.length?ot.some(r[0]):ot.none()},filterItems:Or,justCells:function(n){var e=d(n.all(),function(n){return n.cells()});return S(e)}},Nr=function(n,e,t){var r=n();return b(r,e).orThunk(function(){return ot.from(r[0]).orThunk(t)}).map(function(n){return n.element()})},Ar=function(n){var e=n.grid(),r=fe(0,e.columns()),o=fe(0,e.rows());return d(r,function(e){return Nr(function(){return T(o,function(r){
return Er.getAt(n,r,e).filter(function(n){return n.column()===e}).fold(t([]),function(n){return[n]})})},function(n){return 1===n.colspan()},function(){return Er.getAt(n,0,e)})})},Rr=function(n){var e=n.grid(),r=fe(0,e.rows()),o=fe(0,e.columns());return d(r,function(e){return Nr(function(){return T(o,function(r){return Er.getAt(n,e,r).filter(function(n){return n.row()===e}).fold(t([]),function(n){return[n]})})},function(n){return 1===n.rowspan()},function(){return Er.getAt(n,e,0)})})},Dr=function(n){var e=dr(n);return d(e,function(n){var e=n,t=pn(e).map(function(n){var e=q(n);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}).getOr("tbody"),r=d(lr(n),function(n){var e=H(n,"rowspan")?parseInt(U(n,"rowspan"),10):1,t=H(n,"colspan")?parseInt(U(n,"colspan"),10):1;return At(n,e,t)});return kt(e,r,t)})},kr={resolve:($e="ephox-snooker".replace(/\./g,"-"),{resolve:function(n){return $e+"-"+n}}).resolve},jr=function(n,e,t,r,o){var u=xt.fromTag("div");return nn(u,{position:"absolute",left:e-r/2+"px",top:t+"px",height:o+"px",width:r+"px"}),G(u,{"data-column":n,role:"presentation"}),u},Ir=function(n,e,t,r,o){var u=xt.fromTag("div");return nn(u,{position:"absolute",left:e+"px",top:t-o/2+"px",height:o+"px",width:r+"px"}),G(u,{"data-row":n,role:"presentation"}),u},Mr=kr.resolve("resizer-bar"),Pr=kr.resolve("resizer-rows"),_r=kr.resolve("resizer-cols"),Br=function(n,e,t,r){se(n);var o=Dr(e),u=Er.generate(o),i=Rr(u),c=Ar(u);me(n,e,i,c,t,r)},qr=function(n,e,r,o){var u=function(n,e){return n[e]}(n,e).cells().slice(r),i=de(u,o),c=function(n,e){return d(n,function(n){return Bt(n,e)})}(n,r).slice(e),a=de(c,o);return{colspan:t(i),rowspan:t(a)}},Lr=function(n,e){var t=d(n,function(n,e){return d(n.cells(),function(n,e){return!1})});return d(n,function(r,o){var u=T(r.cells(),function(r,u){if(!1!==t[o][u])return[];var i=qr(n,o,u,e);return function(n,e,r,o){for(var u=n;u<n+r;u++)for(var i=e;i<e+o;i++)t[u][i]=!0}(o,u,i.rowspan(),i.colspan()),[Rt(r.element(),i.rowspan(),i.colspan(),r.isNew())]});return Pt(u,r.section())})},zr=function(n,e,t){for(var r=[],o=0;o<n.grid().rows();o++){for(var u=[],i=0;i<n.grid().columns();i++){var c=Er.getAt(n,o,i).map(function(n){return jt(n.element(),t)}).getOrThunk(function(){return jt(e.gap(),!0)});u.push(c)}var a=Mt(u,n.all()[o].section());r.push(a)}return r},Vr={ltr:Cr.ltr,rtl:Cr.rtl},Fr=(Ke=St,{get:function(n){if(!Ke(n))throw new Error("Can only get "+Je+" value of a "+Je+" node");return Qe(n).getOr("")},getOption:Qe=function(n){return Ke(n)?ot.from(n.dom().nodeValue):ot.none()},set:function(n,e){if(!Ke(n))throw new Error("Can only set raw "+Je+" value of a "+Je+" node");n.dom().nodeValue=e}}),Wr=["img","br"],Gr=function(n,e,t){return{row:Ne(e),cell:function(e){var r=hn(e.element()),o=xt.fromTag(q(e.element()),r.dom()),u=t.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),i=0<u.length?function(n,e,t){return Ce(n).map(function(r){var o=t.join(","),u=Tn(r,o,function(e){return vn(e,n)});return g(u,function(n,e){var t=Vn(e);return X(t,"contenteditable"),vr(n,t),t},e)}).getOr(e)}(e.element(),o,u):o;return vr(i,xt.fromTag("br")),function(n,e){var t=n.dom(),r=e.dom();K(t)&&K(r)&&(r.style.cssText=t.style.cssText)}(e.element(),o),rn(o,"height"),1!==e.colspan()&&rn(e.element(),"width"),n(e.element(),o),o},replace:Ee,gap:Oe}},Ur={isRtl:t(!(Je="text"))},Hr={isRtl:t(!0)},Xr=function(n){return"rtl"===function(n){return"rtl"===en(n,"direction")?"rtl":"ltr"}(n)?Hr:Ur},Yr=function(n,e,t){function r(e){X(e,n.selected()),X(e,n.firstSelected()),X(e,n.lastSelected())}function o(e){W(e,n.selected(),"1")}function u(n){i(n),t()}var i=function(e){var t=Cn(e,n.selectedSelector());v(t,r)};return{clearBeforeUpdate:i,clear:u,selectRange:function(t,r,i,c){u(t),v(r,o),W(i,n.firstSelected(),"1"),W(c,n.lastSelected(),"1"),e(r,i,c)},selectedSelector:n.selectedSelector,firstSelectedSelector:n.firstSelectedSelector,lastSelectedSelector:n.lastSelectedSelector}},$r=function(n,e){for(var t=!0,r=o(_e,e),u=e.startRow();u<=e.finishRow();u++)for(var i=e.startCol();i<=e.finishCol();i++)t=t&&Er.getAt(n,u,i).exists(r);return t?ot.some(e):ot.none()},Kr=function(n,e,t){return Be(n,e,t).bind(function(e){return $r(n,e)})},Jr=function(n){var e=Dr(n);return Er.generate(e)},Qr=function(n,e,t){var r=Jr(n);return Kr(r,e,t)},Zr=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],no=D("left","right"),eo=D("first","second","splits"),to=function(n,e,t,r){var o=e(n,t);return g(r,function(t,r){var o=e(n,r);return ro(n,t,o)},o)},ro=function(n,e,t){return e.bind(function(e){return t.filter(o(n.eq,e))})},oo={sharedOne:function(n,e,t){return 0<t.length?function(n,e,t,r){return r(n,e,t[0],t.slice(1))}(n,e,t,to):ot.none()},subset:function(n,e,t){var r=Ve(n,e,t);return r.shared().bind(function(e){return ze(n,e,r.firstpath(),r.secondpath())})},ancestors:Ve,breakToLeft:function(n,e,t){return qe(n,e,t).map(function(r){var o=n.create().clone(e);return n.insert().appendAll(o,r.before().concat([t])),n.insert().appendAll(e,r.after()),n.insert().before(e,o),no(o,e)})},breakToRight:function(n,e,t){return qe(n,e,t).map(function(t){var r=n.create().clone(e);return n.insert().appendAll(r,t.after()),n.insert().after(e,r),no(e,r)})},breakPath:function(n,e,t,r){var o=function(e,u,i){var c=eo(e,ot.none(),i);return t(e)?eo(e,u,i):n.property().parent(e).bind(function(u){return r(n,u,e).map(function(n){var e=[{first:n.left,second:n.right}],r=t(u)?u:n.left();return o(r,ot.some(n.right()),i.concat(e))})}).getOr(c)};return o(e,ot.none(),[])}},uo={up:t({selector:En,closest:Rn,predicate:On,all:gn}),down:t({selector:Cn,predicate:cr}),styles:t({get:en,getRaw:tn,set:Z,remove:rn}),attrs:t({get:U,set:W,remove:X,copyTo:function(n,e){var t=Y(n);G(e,t)}}),insert:t({before:jn,after:In,afterAll:_n,append:vr,appendAll:Bn,prepend:Mn,wrap:Pn}),remove:t({unwrap:Ln,remove:hr}),create:t({nu:xt.fromTag,clone:function(n){return xt.fromDom(n.dom().cloneNode(!1))},text:xt.fromText}),query:t({comparePosition:function(n,e){return n.dom().compareDocumentPosition(e.dom())},prevSibling:wn,nextSibling:bn}),property:t({children:yn,name:q,parent:pn,document:function(n){return n.dom().ownerDocument},isText:St,isComment:V,isElement:yt,getText:ye,setText:Se,isBoundary:function(n){return!!yt(n)&&("body"===q(n)||s(Zr,q(n)))},isEmptyTag:function(n){return!!yt(n)&&s(["br","img","hr","input"],q(n))}}),eq:vn,is:ir},io=function(n,e){return oo.sharedOne(uo,function(e,t){return n(t)},e)},co=(function(n,e){var t=n.concat(e);if(0===t.length)throw new Error("You must specify at least one required or optional field.");P("required",n),P("optional",e),_(t)}(["boxes","start","finish"],[]),function(n,e){var t=Cn(n,e);return 0<t.length?ot.some(t):ot.none()}),ao=function(n,e,r){return An(n,e).bind(function(e){return An(n,r).bind(function(n){return io(Fe,[e,n]).map(function(r){return{first:t(e),last:t(n),table:t(r)}})})})},fo=function(n,e){return co(n,e)},so=function(n,e,t){return ao(n,e,t).bind(function(e){function t(e){return vn(n,e)}var r=En(e.first(),"thead,tfoot,tbody,table",t),o=En(e.last(),"thead,tfoot,tbody,table",t);return r.bind(function(n){return o.bind(function(t){return vn(n,t)?Qr(e.table(),e.first(),e.last()):ot.none()})})})},lo="data-mce-selected",mo="data-mce-first-selected",vo="data-mce-last-selected",ho={selected:t(lo),selectedSelector:t("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:t("[data-mce-selected]"),firstSelected:t(mo),firstSelectedSelector:t("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:t(vo),lastSelectedSelector:t("td[data-mce-last-selected],th[data-mce-last-selected]")},po=function(e){if(!it(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],r={};return v(e,function(o,u){var i=dt(o);if(1!==i.length)throw new Error("one and only one name per case");var c=i[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!it(a))throw new Error("case arguments must be an array");t.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),i=0;i<o.length;i++)o[i]=arguments[i];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[u].apply(null,o)},match:function(n){var e=dt(n);if(t.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+e.join(","));if(!x(t,function(n){return s(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+t.join(", "));return n[c].apply(null,o)},log:function(e){n.console.log(e,{constructors:t,constructor:c,params:o})}}}}),r}([{none:[]},{multiple:["elements"]},{single:["selection"]}]),go={cata:function(n,e,t,r){return n.fold(e,t,r)},none:po.none,multiple:po.multiple,single:po.single},wo=function(n,e){return go.cata(e.get(),ot.none,function(e){return 0===e.length?ot.none():so(n,ho.firstSelectedSelector(),ho.lastSelectedSelector()).bind(function(n){return 1<e.length?ot.some({bounds:t(n),cells:t(e)}):ot.none()})},ot.none)},bo=function(n,e){var t=We(n,e);return 0<t.length&&x(t,function(n){return H(n,"rowspan")&&1<parseInt(U(n,"rowspan"),10)||H(n,"colspan")&&1<parseInt(U(n,"colspan"),10)})?ot.some(t):ot.none()},yo=We,So=function(n,e,r){return{element:t(r),mergable:t(wo(e,n)),unmergable:t(bo(r,n)),selection:t(yo(r,n))}},To=(Ze="th,td",function(n){return ot.from(n.dom.getParent(n.selection.getStart(),Ze)).map(xt.fromDom)}),xo=function(n){var e=Dr(n);return Er.generate(e).grid()},Co=function(n,e){function t(e){var t,r;return{type:"selectbox",name:"roworcol",label:"column"===e?"Column":"Row",items:"column"===e?function(){var e=i.get().getOrDie("state must be present"),t=e.limit?e.finishCol()+1-e.startCol():e.columns();return m(t,function(t){var r=e.limit?e.startCol():0,o=function(n){for(var e=n,t="";0<Math.floor(e);)--e,t+=String.fromCharCode("A".charCodeAt(0)+e%26),e/=26;return t.split("").reverse().join("")}(t+r+1);return{text:n.translate(["Column {0}",o]),value:""+(t+r)}})}():(t=i.get().getOrDie("state must be present"),r=t.limit?t.finishRow()+1-t.startRow():t.rows(),m(r,function(e){var r=t.limit?t.startRow():0,o=(e+r+1).toString();return{text:n.translate(["Row {0}",o]),value:""+(e+r)}}))}}function r(n){return{title:"Advanced Sort",size:"normal",body:function(n){return{type:"panel",items:[{type:"grid",columns:2,items:[u,t(n),function(n){return{type:"selectbox",name:"sort",label:"Sort",items:["column"===n?{text:"Column",value:"column"}:{text:"Row",value:"row"},{text:"Selection",value:"selection"},{text:"Table",value:"table"}]}}(n),c]}]}}(n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"sort",text:"Sort",primary:!0}]}}function o(){i.set(ot.none())}var u={type:"selectbox",name:"sortby",label:"Sort by",items:[{text:"Column",value:"column"},{text:"Row",value:"row"}]},i=vt(ot.none()),c={type:"selectbox",name:"order",label:"Order",items:[{text:"Ascending",value:"ascending"},{text:"Descending",value:"descending"}]},a=function(e,t){if("sortby"===t.name){var u=e.getData(),c=i.get().getOrDie("state must be present"),f={roworcol:"column"===u.sortby?""+c.startCol():""+c.startRow()},s=qt(qt({},u),f),l=qt(qt({},r(u.sortby)),{onChange:a,onClose:o,onSubmit:Ue(n),initialData:s});e.redial(l),e.focus("sortby")}};To(n).each(function(t){Ge(t,n).each(function(u){function c(e){i.set(ot.some(e));var t={sortby:"column",roworcol:""+e.startCol(),sort:"column",order:"ascending"},u=qt(qt({},r("column")),{onChange:a,onClose:o,onSubmit:Ue(n),initialData:t});n.windowManager.open(u)}var f=So(e,u,t),s=xo(u);f.mergable().fold(function(){Qr(u,t,t).each(function(n){var e=qt(qt(qt({},n),s),{limit:!1});c(e)})},function(n){var e=qt(qt(qt({},n.bounds()),s),{limit:!0});c(e)})})})},Oo=function(n,t,r){function o(n){return{width:Re(n.dom()),height:Re(n.dom())}}function u(n){return"selection"===n}function i(n){return"ascending"===n}function c(n){var e=parseInt(n.roworcol,10);!function(n){return"column"===n}(n.sortby)?function(n,e){!function(n){return"row"===n}(n.sort)?u(n.sort)?i(n.order)?l(t.sortSelectionColumnsAsc(e)):l(t.sortSelectionColumnsDesc(e)):i(n.order)?l(t.sortTableColumnsAsc(e)):l(t.sortTableColumnsDesc(e)):i(n.order)?l(t.sortRowColumnsAsc(e)):l(t.sortRowColumnsDesc(e))}(n,e):function(n,e){!function(n){return"column"===n}(n.sort)?u(n.sort)?i(n.order)?l(t.sortSelectionRowsAsc(e)):l(t.sortSelectionRowsDesc(e)):i(n.order)?l(t.sortTableRowsAsc(e)):l(t.sortTableRowsDesc(e)):i(n.order)?l(t.sortColumnRowsAsc(e)):l(t.sortColumnRowsDesc(e))}(n,e)}function a(){return To(n).bind(function(e){return Ge(e,n).bind(function(n){return Qr(n,e,e).map(function(n){return n.startCol()})})})}function f(){return To(n).bind(function(e){return Ge(e,n).bind(function(n){return Qr(n,e,e).map(function(n){return n.startRow()})})})}var s=Yr(ho,e,e),l=function(e){To(n).each(function(t){Ge(t,n).each(function(u){var i=So(r,u,t),c=o(u);e(u,i).each(function(e){!function(e,t){var r=o(t);e.width===r.width&&e.height===r.height||(function(n,e,t,r){n.fire("ObjectResizeStart",{target:e,width:t,height:r})}(n,t.dom(),e.width,e.height),function(n,e,t,r){n.fire("ObjectResized",{target:e,width:t,height:r})}(n,t.dom(),r.width,r.height))}(c,u),n.selection.setRng(e),n.focus(),s.clear(u),ke(u)})})})};n.addCommand("mceSortTableByColumnAsc",function(){a().each(function(n){l(t.sortTableRowsAsc(n))})}),n.addCommand("mceSortTableByColumnDesc",function(){a().each(function(n){l(t.sortTableRowsDesc(n))})}),n.addCommand("mceSortTableByRowAsc",function(){f().each(function(n){l(t.sortTableColumnsAsc(n))})}),n.addCommand("mceSortTableByRowDesc",function(){f().each(function(n){l(t.sortTableColumnsDesc(n))})}),n.addCommand("mceSortTableAdvanced",function(n,e){return c(e)}),n.addCommand("mceAdvancedTableSort",function(){return Co(n,r)})};tinymce.PluginManager.add("advtable",Xe)}(window);